# Main Nginx configuration file

# Defines the user and group under which Nginx runs
user www-data;

# Defines the number of worker processes
worker_processes auto;

# Defines the error log file and its logging level
error_log /var/log/nginx/error.log warn;

# Defines the PID file
pid /var/run/nginx.pid;

# Events: connection handler configuration
events {
    worker_connections 1024;  # Maximum number of connections per worker process
}

# HTTP: HTTP server configuration
http {
    # Include additional configuration files
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # Access log configuration
    access_log /var/log/nginx/access.log combined;

    # Gzip compression configuration
    gzip on;
    gzip_disable "msie6";

    # Buffer configuration
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;

    # Virtual server list configuration
    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;

    # Default server
    server {
        listen 80;  # Server listening port
        server_name example.com www.example.com;  # Server name

        root /var/www/html;  # Document root
        index index.html index.htm;  # Default files to serve

        location / {
            try_files $uri $uri/ =404;  # Try to serve files, if it doesn't exist, return 404
        }

        # Error configuration
        error_page 404 /404.html;
        location = /404.html {
            internal;
        }

        # Redirection configuration
        location ~ \.php$ {
            include snippets/fastcgi-php.conf;
            fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;
        }

        location ~ /\.ht {
            deny all;
        }
    }
}

